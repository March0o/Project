function PopulateCartCard(){let e=document.getElementById("cartCardBody"),t=document.createElement("ul");t.setAttribute("class","list-group list-group-flush"),t.setAttribute("style","height:13em; overflow-y: scroll;");let l=JSON.parse(localStorage.getItem("CartData"));if(null==Object.values(l.products)||0==Object.values(l.products).length)e.innerHTML="Nothing in Cart";else{let a=Object.values(l.products);for(let r=0;r<a.length;r++)if(null==a[r])console.log("null item in cart");else{let s=a[r],i=document.createElement("a");i.setAttribute("class","list-group-item list-group-item-action"),i.setAttribute("data-bs-toggle","collapse"),i.setAttribute("href","#collapseProduct"+r),i.setAttribute("role","button"),i.setAttribute("aria-expanded","false"),i.setAttribute("aria-controls","collapseProduct"+r),i.innerHTML=s.name+" ("+s.size+") - "+ConvertToEuro(s.price);let n=document.createElement("p");n.setAttribute("class","collapse text-body-tertiary"),n.setAttribute("id","collapseProduct"+r),n.setAttribute("style","clear: both");let u=s.ingredients.split(", ");for(let d=0;d<u.length;d++){let o=document.createElement("p");o.setAttribute("style","margin-left: 2em; font-size: .75em;"),o.innerHTML="- "+u[d],n.appendChild(o)}t.appendChild(i),t.appendChild(n)}e.appendChild(t);let c=document.getElementById("cartFooter"),p=document.createElement("li");p.setAttribute("class","dropdown-item"),p.setAttribute("style","text-align:center; font-weight:bold"),p.innerHTML="Total : "+ConvertToEuro(l.total),c.appendChild(p)}}function AutofillFields(){let e=localStorage.getItem("Eircode"),t=JSON.parse(localStorage.getItem("LoggedUser")),l=document.getElementById("fNameInput"),a=document.getElementById("lNameInput"),r=document.getElementById("emailInput"),s=document.getElementById("eircodeInput"),i=document.getElementById("cNameInput"),n=document.getElementById("cNumberInput"),u=document.getElementById("expiryInput"),d=document.getElementById("cvvInput");console.log(t.card_details),l.value=t.first_name,a.value=t.last_name,r.value=t.email,s.value=e,i.value=t.card_details.split("/")[0],n.value=t.card_details.split("/")[1],u.value=t.card_details.split("/")[2]+"/"+t.card_details.split("/")[3],d.value=t.card_details.split("/")[4]}function SaveCard(){if(!0==document.getElementById("saveCardCheck").checked){let e=document.getElementById("cNameInput").value,t=document.getElementById("cNumberInput").value,l=document.getElementById("expiryInput").value,a=document.getElementById("cvvInput").value,r=JSON.parse(localStorage.getItem("LoggedUser")),s=JSON.parse(localStorage.getItem("AccountData")),i=e+"/"+t+"/"+l+"/"+a;r.card_details=i;for(let n=0;n<Object.values(s.users).length;n++)s.users[n].email==r.email&&(s.users[n].card_details=i);localStorage.setItem("LoggedUser",JSON.stringify(r)),localStorage.setItem("AccountData",JSON.stringify(s))}}PopulateCartCard(),AutofillFields();
