async function FetchProducts(t){try{let e=await fetch(t);if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);let r=await e.json();console.log(r);let l=document.getElementById("ShopOutput"),i=['Ultra - 30" (+'+ConvertToEuro(15)+")",'Large - 25" (+'+ConvertToEuro(10)+")",'Medium - 25" (+'+ConvertToEuro(5)+")",'Small - 10" (+'+ConvertToEuro(0)+")"];r.forEach(t=>{let e=document.createElement("div");e.setAttribute("class","col");let r=document.createElement("div");r.setAttribute("class","card mx-auto h-100"),r.setAttribute("style","width: 27em");let n=document.createElement("div");n.setAttribute("class","card-body");let a=document.createElement("img");a.setAttribute("class","card-img"),a.setAttribute("src","images/placeholderFood.jpg");let s=document.createElement("div");s.setAttribute("class","card-header"),s.textContent=t.product_name+" - "+ConvertToEuro(t.product_price);let o=document.createElement("p");o.setAttribute("class","card-text"),o.setAttribute("style","margin-top: 0.5em;"),o.textContent=t.description;let c=document.createElement("h6");c.setAttribute("class","card-text"),c.setAttribute("style","font-weight: 600"),c.textContent="Ingredients:";let d=document.createElement("p");d.setAttribute("class","card-text text-secondary"),d.textContent=t.ingredients;let u=document.createElement("div");u.setAttribute("class","card-footer"),u.setAttribute("style","background-color: #dc3545;");let p=document.createElement("select");p.setAttribute("class","form-select form-select-lg sizeSelect"),p.setAttribute("style","width: 10em; height: 3em; float: left;");for(let m=0;m<i.length;m++){let h=document.createElement("option");h.setAttribute("style","background-color:white; color:black"),h.textContent=i[m],p.appendChild(h)}u.appendChild(p);let g=document.createElement("button");g.setAttribute("class","btn btn-light"),g.setAttribute("style","width: 10em; height: 3.75em; float: right; font-weight:800;"),g.textContent="Add to Cart",g.setAttribute("onclick","AddToCart(this)"),u.appendChild(g),e.appendChild(r),r.appendChild(s),n.appendChild(a),n.appendChild(o),n.appendChild(c),n.appendChild(d),r.appendChild(n),r.appendChild(u),l.appendChild(e)})}catch(n){console.log(n.message)}}function AddToCart(t){let e=t.parentElement.parentElement,r=e.children[0],l=e.children[1],i=e.children[2],n=r.innerHTML.split(" -")[0],a=l.children[3].innerHTML,s=i.getElementsByClassName("sizeSelect")[0].value,o=s.split(" ")[0],c,d=+s.split("+")[1].slice(1,-1)+ +r.innerHTML.split("- ")[1].substring(1),u=JSON.parse(localStorage.getItem("CartData"));(null==Object.values(u.products)||0==Object.values(u.products).length)&&(u.products=[]),u.products.push({name:n,ingredients:a,size:o,price:d}),u.total+=d,localStorage.setItem("CartData",JSON.stringify(u)),UpdateDisplayCart()}function UpdateDisplayCart(){let t=document.getElementById("cart");t.innerHTML="";let e=JSON.parse(localStorage.getItem("CartData"));if(null==Object.values(e.products)||0==Object.values(e.products).length)t.innerHTML="Add to Cart!",document.getElementById("CartCounter").innerHTML=0;else{let r=Object.values(e.products);for(let l=0;l<r.length;l++)if(null==r[l])console.log("null item in cart");else{let i=document.createElement("li"),n=document.createElement("hr");n.setAttribute("class","dropdown-divider"),i.appendChild(n);let a=r[l],s=document.createElement("li");s.setAttribute("style","width: 20em;");let o=document.createElement("a");o.setAttribute("class","dropdown-item"),o.setAttribute("style","width: 15em; float: left; margin-right: 0;"),o.setAttribute("data-bs-toggle","collapse"),o.setAttribute("href","#collapseProduct"+l),o.setAttribute("role","button"),o.setAttribute("aria-expanded","false"),o.setAttribute("aria-controls","collapseProduct"+l),o.innerHTML=a.name+" ("+a.size+") - "+ConvertToEuro(a.price);let c=document.createElement("button");c.setAttribute("class","btn btn-outline-danger"),c.setAttribute("style","margin-left: 1em; width: 4em; float; right;"),c.setAttribute("onclick","BinProduct(this)");let d=document.createElement("img");d.setAttribute("src","images/bin.webp"),d.setAttribute("style","height: 1em"),c.appendChild(d);let u=document.createElement("p");u.setAttribute("class","collapse text-body-tertiary"),u.setAttribute("id","collapseProduct"+l),u.setAttribute("style","clear: both");let p=a.ingredients.split(", ");for(let m=0;m<p.length;m++){let h=document.createElement("p");h.setAttribute("style","margin-left: 2em; font-size: .75em;"),h.innerHTML="- "+p[m],u.appendChild(h)}s.appendChild(o),s.appendChild(c),s.appendChild(u),t.appendChild(s),t.appendChild(i)}let g=document.createElement("li");g.setAttribute("class","dropdown-item"),g.setAttribute("style","text-align:center; font-weight:bold"),g.innerHTML="Total : "+ConvertToEuro(e.total),t.appendChild(g);let b=document.createElement("li");b.setAttribute("class","dropdown-item"),b.setAttribute("style","text-align:center;");let C=document.createElement("a");C.setAttribute("class","btn btn-danger"),C.setAttribute("role","button"),C.setAttribute("onclick","Checkout()"),C.setAttribute("style","width:10em; border-radius: 15px"),C.innerHTML="Checkout",b.appendChild(C),t.appendChild(b),document.getElementById("CartCounter").innerHTML=r.length}}function ConvertToEuro(t){return t.toLocaleString("en-IE",{style:"currency",currency:"EUR"})}function Checkout(){"Guest"===localStorage.getItem("LoggedUser")?alert("Please log in or create an account before entering checkout"):window.open("checkout.html","_self")}function BinProduct(t){let e=JSON.parse(localStorage.getItem("CartData")),r=t.parentElement,l=r.parentElement,i=r.children[0].href.split("collapseProduct")[1];e.products[i];let n=e.products[i].price;e.total-=n,e.products.splice(i,1),(null==Object.values(e.products)||0==Object.values(e.products).length)&&(e.products=[]),localStorage.setItem("CartData",JSON.stringify(e)),l.removeChild(r),UpdateDisplayCart()}function ClearCart(){document.getElementById("cart").innerHTML="",localStorage.setItem("CartData",JSON.stringify({products:[],total:0}))}function CheckEircode(){let t=window.location.href;if(console.log(t),t.includes("Eircode=")){let e=t.split("Eircode=")[1],r,l=e.split("+")[0]+" "+e.split("+")[1];console.log(l),localStorage.setItem("Eircode",l)}else null===localStorage.getItem("Eircode")?(localStorage.setItem("Eircode",""),console.log("No Eircode")):console.log(localStorage.getItem("Eircode"))}FetchProducts("https://raw.githubusercontent.com/March0o/JsonProject/main/FoodData.json"),CheckEircode(),null===localStorage.getItem("CartData")&&localStorage.setItem("CartData",JSON.stringify({products:[],total:0})),UpdateDisplayCart();